# (grep ^# a.lgo; pclgo a.lgo a2.legofit a2boot*.legofit; grep -v ^# a.lgo | egrep -v "\<free\>")
# Gene flow: N->Y, S->D, XY->N
# TmN < Tv < Ta
# Neanderthal population size allowed to change
# PCA calculated with gsl_linalg_SV_decomp
# Fraction of variance:
#      pc1      pc2      pc3      pc4      pc5      pc6      pc7      pc8
#  0.22896  0.16225  0.14689  0.13443  0.10457  0.06042  0.05727  0.04326
#      pc9     pc10     pc11     pc12     pc13     pc14     pc15
#  0.02764  0.01871  0.00839  0.00549  0.00143  0.00028  0.00002
param free [    -4,      4] pc1 = 0
param free [    -2,      2] pc2 = 0
param free [    -2,      2] pc3 = 0
param free [    -4,      4] pc4 = 0
param free [    -2,      2] pc5 = 0
param free [    -2,      2] pc6 = 0
param free [    -2,      2] pc7 = 0
param free [    -2,      2] pc8 = 0
param free [    -2,      2] pc9 = 0
param free [    -2,      2] pc10 = 0
param free [    -2,      2] pc11 = 0
param free [    -1,      1] pc12 = 0
param free [    -1,      1] pc13 = 0
param free [  -0.5,    0.5] pc14 = 0
param free [ -0.25,   0.25] pc15 = 0
time constrained Txynds = 135539.6274509804 - 5414.277374033295*pc1 +
    1391.382588523311*pc2 + 1084.057560151707*pc3 +
    5102.027734690235*pc4 + 2675.754737215962*pc5 +
    50.91838359952751*pc6 + 5115.514052482153*pc7 +
    2420.94124420108*pc8 - 3597.925603967207*pc9 -
    1363.168922016575*pc10 + 1109.580635633497*pc11 +
    9659.556156817322*pc12 - 2164.344217541062*pc13 -
    357.9146183277298*pc14 - 91.3573351030484*pc15
time constrained Tnd = 25854.69803921568 - 7.518386035532172*pc1 -
    14.03350029437957*pc2 + 17.63958980046901*pc3 +
    10.88458418928261*pc4 - 15.75454937718213*pc5 +
    0.7315553039063499*pc6 - 5.506335977689907*pc7 -
    2.033661439119865*pc8 + 6.274875012992683*pc9 +
    0.28344821658097*pc10 + 3.093037263328671*pc11 +
    0.1710337999425839*pc12 - 0.2471971229976038*pc13 +
    1.030546235427741*pc14 + 31.90331422190006*pc15
time constrained Tav = 9998.702745098044 + 235.1146102227856*pc1 +
    289.4722606787455*pc2 + 231.6928098960448*pc3 +
    104.1883732238666*pc4 - 14.51891605150325*pc5 -
    34.35887597755442*pc6 + 15.80622458550931*pc7 -
    17.68955781978994*pc8 - 3.146073334642562*pc9 -
    106.2152626102589*pc10 + 89.9569014013455*pc11 -
    15.83080526828165*pc12 - 85.42372127328075*pc13 +
    555.7045966060815*pc14 - 11.37957066629941*pc15
time constrained Txy = 5650.976666666666 - 100.8387062081527*pc1 +
    52.03089782385581*pc2 + 77.3401400532679*pc3 -
    135.0250860551275*pc4 - 2.58340359045645*pc5 +
    74.27505864123081*pc6 - 61.7227826583398*pc7 -
    5.026410863303524*pc8 - 41.27474119487053*pc9 -
    16.51561452354152*pc10 + 43.44651486175984*pc11 +
    59.93900252915554*pc12 + 215.8443690826362*pc13 +
    39.0638488491883*pc14 - 7.381970210382613*pc15
time constrained Td = 3399.179215686275 + 20.39984218933759*pc1 -
    24.57444023407357*pc2 - 0.6407249045066956*pc3 +
    18.62076614958054*pc4 + 24.58798939717675*pc5 -
    10.64003047233964*pc6 - 64.47676942224024*pc7 +
    41.2942504139222*pc8 - 45.39270371243707*pc9 -
    6.841513623975141*pc10 + 12.14505425849758*pc11 +
    3.257489781114518*pc12 + 1.102156958865476*pc13 +
    0.8037084776852059*pc14 - 0.3344405663564785*pc15
time constrained Ta = 5113.009607843137 + 21.97333340347587*pc1 -
    18.77001770059898*pc2 + 17.848347931811*pc3 -
    1.973771217932996*pc4 + 20.88203172472327*pc5 +
    32.00607469781613*pc6 + 25.56213018702595*pc7 -
    3.603498098882346*pc8 - 10.52110400918258*pc9 +
    25.1669086976246*pc10 + 40.85911762326327*pc11 -
    9.997850855964051*pc12 - 0.6281306171528297*pc13 -
    7.160095409637822*pc14 - 0.3485814409336258*pc15
time constrained Tv = 2352.388431372549 + 22.98278831691729*pc1 -
    23.59551747680288*pc2 + 23.66416818053494*pc3 -
    1.316051226805212*pc4 + 30.51099042462972*pc5 +
    26.26991055041767*pc6 + 3.222335065248786*pc7 -
    12.37130307957685*pc8 + 6.396463901937393*pc9 -
    20.6382588945557*pc10 - 54.75545478592133*pc11 +
    14.19424076084988*pc12 + 5.628848726602987*pc13 +
    1.124819771431957*pc14 + 0.7991503254372324*pc15
twoN constrained twoNav = 19109.96862745098 + 212.7089074584933*pc1 +
    505.7084784930806*pc2 + 199.8024773503514*pc3 +
    261.0207063836236*pc4 - 421.5052407284785*pc5 +
    237.5782022821414*pc6 + 16.71509104236213*pc7 +
    95.65496215596507*pc8 - 516.9923559598983*pc9 +
    570.158140538759*pc10 - 479.7431669030896*pc11 -
    75.2998861976815*pc12 + 103.3111372645554*pc13 -
    281.5263256214836*pc14 + 21.86458407935168*pc15
twoN constrained twoNn = 5029.864117647058 + 116.08892436539*pc1 +
    133.2781773740632*pc2 + 108.0422934318585*pc3 +
    33.36353960518461*pc4 + 5.853286035547559*pc5 -
    56.74993487596552*pc6 - 20.3625449262976*pc7 -
    19.73313222975011*pc8 + 65.42988105284479*pc9 -
    156.8319194603346*pc10 + 87.99348614504787*pc11 +
    22.13110369051496*pc12 + 32.54439832188874*pc13 -
    211.4406529620128*pc14 + 1.239687084689675*pc15
twoN constrained twoNnd = 157.3191921568628 + 17.66457486792561*pc1 +
    33.29644507760071*pc2 - 42.76022486965585*pc3 -
    26.43840024997839*pc4 + 37.55180526997166*pc5 -
    1.774702178398601*pc6 + 14.32397951138641*pc7 +
    6.069900684894314*pc8 - 15.52558318957586*pc9 -
    2.861648154202326*pc10 - 4.287424545733312*pc11 +
    0.3985469127130675*pc12 + 4.317172225983606*pc13 +
    0.9230317261310905*pc14 + 76.41170397368856*pc15
twoN constrained twoNxy = 40575.28235294119 + 281.1050492801906*pc1 -
    177.4280602146636*pc2 - 240.4661640945007*pc3 +
    368.0775889184139*pc4 - 76.69014231549038*pc5 -
    214.8534039722281*pc6 + 247.464867832117*pc7 +
    135.1021456843575*pc8 + 169.9795561083251*pc9 +
    75.24716922553114*pc10 + 1.845880754001887*pc11 +
    91.79982796660576*pc12 + 630.9132867888324*pc13 +
    100.9660096213415*pc14 - 19.18991266089703*pc15
twoN constrained twoNxynd = 41331.51176470587 +
    31.46546790489563*pc1 - 17.92370139537267*pc2 +
    62.62713547689036*pc3 - 116.820322884401*pc4 -
    46.83549384485703*pc5 - 19.31847002708986*pc6 +
    67.41662258329718*pc7 + 227.9295232892067*pc8 +
    58.03835862911577*pc9 + 4.310167163999904*pc10 -
    26.90524787847228*pc11 + 13.14712604117867*pc12 -
    31.88063995712255*pc13 - 4.299676182505364*pc14 -
    0.7840314286419611*pc15
mixFrac constrained mN = 0.01888769803921569 - 0.0001036117468181356*pc1 +
    0.0002502243961012065*pc2 - 0.0001644762818239735*pc3 +
    0.0002801801933840515*pc4 + 0.0001627001673602293*pc5 +
    0.0004982921646891476*pc6 - 0.0002925041344521415*pc7 +
    0.0002452399570116794*pc8 + 0.0005340585409812881*pc9 +
    0.0001535477935130107*pc10 + 3.849245202782122e-05*pc11 +
    3.274237377742729e-05*pc12 - 2.550686375957246e-05*pc13 +
    3.968153443045901e-06*pc14 + 4.429074101695149e-06*pc15
mixFrac constrained mS = 0.01143149215686275 + 0.0008032094462736072*pc1 -
    0.0001624379592130637*pc2 - 0.0003318024750317067*pc3 -
    0.0005421081330521033*pc4 - 0.0005727552054700674*pc5 +
    3.992091330691613e-05*pc6 - 0.0004710612214463413*pc7 -
    0.0004546726321332467*pc8 + 0.0002396800914403207*pc9 +
    0.0005099253739487635*pc10 + 0.0002145134696065189*pc11 +
    0.001385183662723784*pc12 - 0.0003190824311621397*pc13 +
    2.588412715430276e-05*pc14 + 8.999320450600928e-06*pc15
mixFrac constrained mXY = 0.008537236470588237 -
    0.0001781388156693228*pc1 + 0.0001547583864956064*pc2 +
    0.0005755094708235766*pc3 - 6.528797598816291e-05*pc4 +
    0.000779966032234071*pc5 - 0.0008933590596516124*pc6 -
    0.0001934666004908055*pc7 - 0.0001477580118755175*pc8 +
    0.0003973548319495528*pc9 + 0.0009496741000801206*pc10 -
    0.0001475855318454579*pc11 + 8.550983720356332e-05*pc12 +
    5.447857290522539e-05*pc13 - 4.809008306001418e-05*pc14 +
    2.22388541285657e-05*pc15
time fixed  zero = 0
twoN fixed  one = 1
time fixed  TmN = 1        # no coalesc. events can happen b/t 0 and Tv
time fixed  Txynd = 25920  # \citet[table~S12.2, p.~90]{Li:N-505-43-S88}
time constrained TmXY = 0.5*(Txy + Tav)
time constrained TmS = 0.5*(Td + Tnd)
segment x    t=zero   twoN=one     samples=1
segment y    t=zero   twoN=one     samples=1
segment v    t=Tv     twoN=twoNn   samples=1
segment a    t=Ta     twoN=twoNn   samples=1
segment a2   t=TmXY   twoN=twoNn
segment d    t=Td     twoN=one     samples=1
segment d2   t=TmS    twoN=one
segment y2   t=TmN    twoN=one
segment n    t=TmN    twoN=twoNn
segment s    t=TmS    twoN=one
segment av   t=Tav    twoN=twoNav
segment nd   t=Tnd    twoN=twoNnd
segment xy   t=Txy    twoN=twoNxy
segment xy2  t=TmXY   twoN=twoNxy
segment xynd t=Txynd  twoN=twoNxynd
segment xynds t=Txynds twoN=twoNxynd
mix    d  from d2 + mS * s
mix    y from y2 + mN * n
mix    a from a2 + mXY * xy2
derive n from v
derive v from a
derive a2 from av
derive av from nd
derive d2 from nd
derive x from xy
derive y2 from xy
derive xy from xy2
derive xy2 from xynd
derive nd from xynd
derive s  from xynds
derive xynd from xynds


# (grep ^# a.lgo; pclgo a.lgo a2.legofit a2boot*.legofit; grep -v ^# a.lgo | egrep -v "\<free\>")
# Gene flow: N->Y, S->ND
# S = superarchaic; XY = early modern; ND = Neandersovan; Y = Europe;
# A, Altai; V=Vindija; D=Denisovan. Altai and Vindija on same branch
# TmN < Tv < Ta
# Neanderthal population size allowed to change
# PCA calculated with gsl_linalg_SV_decomp
# Fraction of variance:
#      pc1      pc2      pc3      pc4      pc5      pc6      pc7      pc8
#  0.31193  0.16779  0.15630  0.11919  0.07615  0.06891  0.04877  0.02159
#      pc9     pc10     pc11     pc12     pc13     pc14
#  0.01907  0.00585  0.00375  0.00053  0.00016  0.00001
param free [    -4,      4] pc1 = 0
param free [    -4,      4] pc2 = 0
param free [    -2,      2] pc3 = 0
param free [    -2,      2] pc4 = 0
param free [    -2,      2] pc5 = 0
param free [    -2,      2] pc6 = 0
param free [    -2,      2] pc7 = 0
param free [    -2,      2] pc8 = 0
param free [    -2,      2] pc9 = 0
param free [    -1,      1] pc10 = 0
param free [    -1,      1] pc11 = 0
param free [    -1,      1] pc12 = 0
param free [  -0.5,    0.5] pc13 = 0
param free [ -0.25,   0.25] pc14 = 0
time constrained Txynds = 118251.8039215686 + 3116.589607294124*pc1 +
    2821.203214065622*pc2 + 2660.998839381449*pc3 -
    256.6854192789791*pc4 - 5517.106074099875*pc5 +
    705.1045775969114*pc6 + 3522.781846201978*pc7 -
    3166.276227196096*pc8 + 471.8357118568812*pc9 -
    1753.876614721455*pc10 - 6473.698526908131*pc11 -
    288.2378067651791*pc12 + 415.2191280474304*pc13 -
    121.0300096393176*pc14
time constrained Tnd = 25738.0568627451 + 0.2888728385541525*pc1 -
    52.3072312653089*pc2 + 12.28006046496541*pc3 -
    23.54766436667336*pc4 - 26.94620011208348*pc5 -
    1.296274080636966*pc6 - 2.800244737700588*pc7 +
    3.099622028481122*pc8 - 6.207774828687523*pc9 -
    1.915464175139637*pc10 + 4.083018070631164*pc11 -
    1.029887433085541*pc12 - 5.4568422457235*pc13 -
    64.82739599933888*pc14
time constrained Tav = 10485.2731372549 + 230.2430290106134*pc1 -
    21.03930201785919*pc2 - 315.0491843954446*pc3 -
    156.2316735409137*pc4 + 46.03588151501845*pc5 -
    83.54054633447396*pc6 + 142.9239006035176*pc7 -
    37.19531517641372*pc8 - 63.41310139140387*pc9 -
    110.7455539941127*pc10 + 42.62548969934591*pc11 -
    375.4758868051682*pc12 - 385.5459997904808*pc13 +
    40.10277166492888*pc14
time constrained Txy = 2296.45994117647 + 335.8404098932072*pc1 +
    17.99892841442962*pc2 + 199.6837960059032*pc3 -
    33.27449891912926*pc4 + 146.7084904199661*pc5 +
    21.89880263718074*pc6 - 209.9279763805483*pc7 +
    304.0651860807118*pc8 - 40.34689059954288*pc9 -
    103.1979996217812*pc10 - 151.6503295302083*pc11 +
    393.4901642644721*pc12 - 405.6632933015748*pc13 +
    24.33008445932234*pc14
time constrained Td = 2678.676862745097 - 11.65676392625381*pc1 +
    9.573587500872854*pc2 - 9.822481446694862*pc3 +
    18.81775927734272*pc4 - 27.99035556765105*pc5 -
    77.58121587275301*pc6 - 34.00139762901032*pc7 +
    2.507088018541972*pc8 - 15.76165639902065*pc9 -
    12.68793809475424*pc10 - 8.40445798932169*pc11 +
    0.6900006147270096*pc12 - 1.845677565140627*pc13 -
    0.1988838596301681*pc14
time constrained Ta = 5778.051764705882 - 20.3643227628618*pc1 +
    21.02537956299035*pc2 + 9.31516805471747*pc3 -
    61.75462782731631*pc4 + 14.93883363160484*pc5 -
    12.22265364682812*pc6 - 5.710883757255131*pc7 -
    9.941777000394197*pc8 + 33.94010884641766*pc9 -
    60.57115924765658*pc10 + 12.48486900956318*pc11 +
    9.878620935308492*pc12 + 10.87093374395627*pc13 -
    0.7991736254306246*pc14
time constrained Tv = 3008.885882352942 - 12.48266361709002*pc1 +
    31.77455836697128*pc2 + 4.56136459983219*pc3 -
    62.5100065868995*pc4 - 4.348957858042859*pc5 -
    13.41568748969635*pc6 - 0.7019625972110624*pc7 +
    14.78671257224714*pc8 - 17.31770795640534*pc9 +
    65.88637995820373*pc10 - 12.48135208379561*pc11 -
    0.8076056808045624*pc12 - 3.562442032415989*pc13 -
    0.07216288117613615*pc14
twoN constrained twoNav = 18593.81568627451 + 382.0651013263044*pc1 -
    189.1267467284575*pc2 - 411.119327081739*pc3 -
    17.37036883020703*pc4 - 4.29369553621601*pc5 -
    259.5680217491588*pc6 + 38.62635357892672*pc7 +
    103.0354075175885*pc8 + 860.6023054495096*pc9 +
    313.6479203887133*pc10 - 137.1245045019123*pc11 +
    184.6920050532924*pc12 + 211.9843692534985*pc13 -
    28.12332562628541*pc14
twoN constrained twoNn = 5030.044705882352 + 123.3616691497447*pc1 -
    6.151513377363257*pc2 - 163.381682239623*pc3 -
    59.12546242208379*pc4 + 29.43399870919209*pc5 -
    17.90056848032764*pc6 + 82.01202425834254*pc7 -
    27.73186256112276*pc8 - 194.0556984190384*pc9 -
    48.8347213756109*pc10 + 25.00393083064596*pc11 +
    167.1328559792405*pc12 + 156.3331287231765*pc13 -
    14.91861311349202*pc14
twoN constrained twoNnd = 416.936450980392 + 1.384194206080513*pc1 +
    120.2791376540725*pc2 - 25.73278710404808*pc3 +
    54.00849593074924*pc4 + 62.40143578510521*pc5 +
    2.481200943666835*pc6 + 7.101832640041693*pc7 -
    9.648045949762031*pc8 + 13.40551849581043*pc9 +
    4.409579173693245*pc10 - 2.057071211016898*pc11 -
    3.015706620398957*pc12 - 12.35204354925073*pc13 -
    148.7471112789726*pc14
twoN constrained twoNxy = 51183.51176470589 - 1143.824397078679*pc1 -
    175.021721643037*pc2 - 645.7678219089452*pc3 +
    113.4788202524947*pc4 - 312.6163030979008*pc5 +
    7.155997931385149*pc6 + 624.0693876737101*pc7 -
    1167.357549828546*pc8 + 218.0774439660181*pc9 +
    284.2129517992461*pc10 + 69.26937436476796*pc11 +
    1399.067802185726*pc12 - 1350.150196410255*pc13 +
    86.10882543006217*pc14
twoN constrained twoNxynd = 40201.63921568629 +
    94.93960447556307*pc1 - 62.67152399535438*pc2 +
    108.1620233337497*pc3 - 16.71284627059225*pc4 +
    157.8138798277033*pc5 - 75.89527877355518*pc6 -
    79.04983077117687*pc7 - 251.2029468262463*pc8 -
    18.55479698789451*pc9 + 67.41348290730005*pc10 -
    17.64158002350167*pc11 - 18.89006076839073*pc12 +
    9.177558790188712*pc13 + 3.075930751726708*pc14
mixFrac constrained mN = 0.02333878039215686 + 9.192360689028817e-05*pc1 +
    0.0001319471320529492*pc2 - 0.0003295146501900634*pc3 -
    8.900002745483957e-05*pc4 - 0.0002988246697109731*pc5 +
    0.0004173767584454743*pc6 - 0.0006834243694020164*pc7 -
    0.0002316530128587027*pc8 + 1.224642801788655e-05*pc9 +
    7.475366237920417e-06*pc10 + 1.099999145007993e-05*pc11 -
    1.104743426825841e-05*pc12 + 3.441773337880941e-06*pc13 -
    2.651824615474975e-06*pc14
mixFrac constrained mSND = 0.01791205411764706 -
    0.001298837887446137*pc1 - 0.0009047468944880341*pc2 -
    0.001004109668906218*pc3 - 0.0001369208813126546*pc4 +
    0.001356821399605004*pc5 + 0.0003106248380164834*pc6 -
    0.0004169015378799628*pc7 + 0.0003464940257935845*pc8 -
    0.0003160886841595201*pc9 - 0.000409349569489206*pc10 -
    0.002825444048571911*pc11 - 0.0003431994870121775*pc12 +
    0.0002372672677080869*pc13 - 0.000101970376240646*pc14
time fixed  zero = 0
twoN fixed  one = 1
time fixed  TmN = 1        # no coalesc. events can happen b/t 0 and Tv
time fixed  Txynd = 25920  # \citet[table~S12.2, p.~90]{Li:N-505-43-S88}
twoN fixed  twoNs = 2000
time constrained TmSND = 0.5*(Tnd + Txynd)
segment x    t=zero   twoN=one     samples=1
segment y    t=zero   twoN=one     samples=1
segment v    t=Tv     twoN=twoNn   samples=1
segment a    t=Ta     twoN=twoNn   samples=1
segment d    t=Td     twoN=one     samples=1
segment y2   t=TmN    twoN=one
segment n    t=TmN    twoN=twoNn
segment s    t=TmSND  twoN=twoNs
segment av   t=Tav    twoN=twoNav
segment nd   t=Tnd    twoN=twoNnd
segment nd2  t=TmSND  twoN=twoNnd
segment xy   t=Txy    twoN=twoNxy
segment xynd t=Txynd  twoN=twoNxynd
segment xynds t=Txynds twoN=twoNxynd
mix    y    from y2 + mN * n
mix    nd   from nd2 + mSND * s
derive n    from v
derive v    from a
derive a    from av
derive av   from nd
derive d    from nd
derive x    from xy
derive y2   from xy
derive xy   from xynd
derive nd2  from xynd
derive s    from xynds
derive xynd from xynds


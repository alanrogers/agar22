# (grep ^# a.lgo; pclgo a.lgo a2.legofit a2boot*.legofit; grep -v ^# a.lgo | egrep -v "\<free\>")
# Gene flow: N->Y, S->D
# S = superarchaic; XY = early modern; Y = Europe; A=Altai; V=Vindija; 
# D=Denisovan
# Altai and Vindija on same branch
# TmN < Tv < Ta
# Neanderthal population size allowed to change
# PCA calculated with gsl_linalg_SV_decomp
# Fraction of variance:
#      pc1      pc2      pc3      pc4      pc5      pc6      pc7      pc8
#  0.33418  0.21769  0.13241  0.09970  0.07530  0.05250  0.03111  0.02654
#      pc9     pc10     pc11     pc12     pc13     pc14
#  0.01919  0.00523  0.00426  0.00162  0.00025  0.00002
param free [    -2,      2] pc1 = 0
param free [    -2,      2] pc2 = 0
param free [    -2,      2] pc3 = 0
param free [    -2,      2] pc4 = 0
param free [    -2,      2] pc5 = 0
param free [    -2,      2] pc6 = 0
param free [    -2,      2] pc7 = 0
param free [    -2,      2] pc8 = 0
param free [    -2,      2] pc9 = 0
param free [    -1,      1] pc10 = 0
param free [    -1,      1] pc11 = 0
param free [    -1,      1] pc12 = 0
param free [  -0.5,    0.5] pc13 = 0
param free [ -0.25,   0.25] pc14 = 0
time constrained Txynds = 90241.54313725489 - 2973.773136939611*pc1 -
    4021.338065407622*pc2 + 2943.594431174316*pc3 -
    1466.691190244668*pc4 + 3288.060060221518*pc5 +
    1071.691661995427*pc6 - 820.9224713956035*pc7 +
    2448.142981710243*pc8 - 2191.947118846614*pc9 +
    6270.443362564715*pc10 + 5551.392549125924*pc11 +
    1031.96495514772*pc12 + 225.3910049633519*pc13 -
    29.33095416972951*pc14
time constrained Tnd = 25864.14509803922 - 3.195902953918114*pc1 +
    10.50480744929721*pc2 + 21.51498739724488*pc3 +
    4.302591358558865*pc4 - 5.156146902484089*pc5 +
    1.640832033698132*pc6 + 0.8757121052250431*pc7 +
    0.6380851939302732*pc8 + 3.974924221097469*pc9 +
    1.095795620533349*pc10 - 1.240648442386525*pc11 -
    0.1108359634393622*pc12 - 1.500347748003115*pc13 +
    25.49321562617481*pc14
time constrained Tav = 8761.85588235294 + 198.7416377004697*pc1 -
    16.87056909686106*pc2 + 87.94152473388242*pc3 -
    192.392291059374*pc4 + 7.635780524207011*pc5 +
    163.0004714624192*pc6 - 25.93221334289703*pc7 -
    121.0891270422236*pc8 - 95.04350203015325*pc9 +
    26.7087664842788*pc10 - 57.49507187315074*pc11 +
    79.98239795730927*pc12 - 365.6700523225231*pc13 -
    25.2059333129236*pc14
time constrained Txy = 6268.327254901961 + 153.9627481221351*pc1 +
    65.28046610706403*pc2 + 21.32591513191808*pc3 +
    49.34654138501347*pc4 + 132.6140795146614*pc5 -
    122.9569730866076*pc6 - 65.04445335588164*pc7 +
    77.3928861250893*pc8 - 11.91447880433401*pc9 +
    98.22189868556249*pc10 - 28.96061393909847*pc11 -
    276.6186067210162*pc12 - 58.39885543919846*pc13 -
    7.304960950841714*pc14
time constrained Td = 3402.475882352941 - 7.547758822710704*pc1 +
    35.62792541012389*pc2 - 17.28559547910222*pc3 -
    41.54993313325439*pc4 - 47.78081514645038*pc5 +
    0.2414244290703806*pc6 - 40.049324012272*pc7 +
    62.84463693099394*pc8 - 25.4677702113748*pc9 +
    2.169142481563203*pc10 + 1.856684342940214*pc11 +
    1.15494914248716*pc12 - 0.1681431666312294*pc13 +
    0.06003584612082562*pc14
time constrained Ta = 5152.416666666668 - 22.7960567526119*pc1 +
    30.19356008144029*pc2 - 10.326598953994*pc3 -
    42.35303159327923*pc4 + 36.96082412524419*pc5 +
    10.89803440607197*pc6 + 7.689011237490783*pc7 -
    8.295940063401298*pc8 + 23.02000637534925*pc9 +
    37.22930229493436*pc10 - 50.53050461983197*pc11 +
    8.056148193665399*pc12 + 20.23279704732449*pc13 +
    0.858531496116426*pc14
time constrained Tv = 2347.16156862745 - 19.80499946348058*pc1 +
    40.07678543255637*pc2 - 1.925723702716466*pc3 -
    40.12009719525629*pc4 + 31.13401853962583*pc5 -
    13.75506823392359*pc6 + 7.937673433449669*pc7 -
    20.82247305650665*pc8 + 6.192357588537126*pc9 -
    42.58309098965324*pc10 + 57.10803053486871*pc11 -
    15.17105932366862*pc12 - 8.129011937903703*pc13 -
    0.069955200761717*pc14
twoN constrained twoNav = 19973.5 + 301.2362698659919*pc1 -
    221.7727912448098*pc2 + 49.42098174913081*pc3 -
    192.2850841338039*pc4 - 15.51345123191497*pc5 +
    269.9246357156733*pc6 - 208.0311850476848*pc7 +
    176.71578699323*pc8 + 674.9831846265438*pc9 -
    97.66900112415534*pc10 + 153.3746910736131*pc11 -
    54.7558261876102*pc12 + 143.4214676834709*pc13 +
    16.72504821810377*pc14
twoN constrained twoNn = 4197.287647058823 + 155.5525248446832*pc1 -
    4.566124384349676*pc2 + 65.80676205443278*pc3 -
    95.17149417568857*pc4 - 25.06361470945396*pc5 +
    80.94262997234632*pc6 + 1.140566863716163*pc7 -
    109.4499127913704*pc8 - 170.1269232143623*pc9 -
    12.4801517763408*pc10 + 15.12765298694669*pc11 -
    57.12206936967453*pc12 + 249.6649925558724*pc13 +
    16.57235410529981*pc14
twoN constrained twoNnd = 134.5658156862745 + 7.120667841495513*pc1 -
    25.47872249616789*pc2 - 50.83316632710966*pc3 -
    10.48089806867709*pc4 + 12.80453494277054*pc5 -
    4.00011489071514*pc6 - 1.448407345646682*pc7 -
    1.022585022242463*pc8 - 10.36368876215643*pc9 -
    2.055575783323528*pc10 + 1.885473237619816*pc11 -
    0.9187487347863322*pc12 - 4.862950548139381*pc13 +
    60.48946938753713*pc14
twoN constrained twoNxy = 39463.40980392157 - 377.6767463120873*pc1 -
    139.6455700243022*pc2 - 110.7662208191554*pc3 -
    91.92280621288364*pc4 - 396.9945029432826*pc5 +
    405.1047622702504*pc6 + 284.1305887519592*pc7 -
    152.0127077962969*pc8 + 49.58986979598435*pc9 +
    124.7645597759951*pc10 + 6.937720632976803*pc11 -
    679.1731428626466*pc12 - 126.9192307755259*pc13 -
    16.31193302764488*pc14
twoN constrained twoNxynd = 42057.95098039214 +
    89.64032242146236*pc1 + 94.65581181208388*pc2 -
    48.16929515034445*pc3 + 63.23493042867495*pc4 +
    58.0276507577539*pc5 + 138.7768695974521*pc6 +
    219.8873585953926*pc7 + 157.9644311127831*pc8 -
    23.35629135673571*pc9 - 1.557691578204097*pc10 +
    46.74466954021013*pc11 + 33.84156750579413*pc12 +
    0.6990411175046598*pc13 - 0.3175375010028552*pc14
mixFrac constrained mN = 0.01890392549019608 + 0.0001532373370222427*pc1 -
    0.0002077191268718275*pc2 + 0.0001335665550914569*pc3 -
    0.0003784016155005647*pc4 - 0.000256174687699359*pc5 -
    0.0005385232682792674*pc6 + 0.0005134450399029559*pc7 +
    9.819123099125551e-05*pc8 + 0.0001091472341707458*pc9 +
    9.442590269999047e-05*pc10 - 2.065527176018338e-05*pc11 +
    3.362846304613935e-05*pc12 - 8.894742963907937e-07*pc13 -
    3.290417525721313e-06*pc14
mixFrac constrained mS = 0.02248330784313726 + 0.001063552205131968*pc1 +
    0.001707428082881781*pc2 - 0.001344818898107956*pc3 +
    0.0007219988448325576*pc4 - 0.001480141178698335*pc5 -
    0.0003554252926190482*pc6 - 0.000167627228328621*pc7 -
    0.001739626495853672*pc8 + 0.0009296470073839721*pc9 +
    0.002561158852294151*pc10 + 0.001741069869152127*pc11 +
    0.0007033756527323302*pc12 + 1.6715815875383e-05*pc13 +
    4.940939709025753e-05*pc14
time fixed  zero = 0
twoN fixed  one = 1
time fixed  TmN = 1        # no coalesc. events can happen b/t 0 and Tv
time fixed  Txynd = 25920  # \citet[table~S12.2, p.~90]{Li:N-505-43-S88}
time constrained TmS = 0.5*(Td + Tnd)
segment x    t=zero   twoN=one     samples=1
segment y    t=zero   twoN=one     samples=1
segment v    t=Tv     twoN=twoNn   samples=1
segment a    t=Ta     twoN=twoNn   samples=1
segment d    t=Td     twoN=one     samples=1
segment d2   t=TmS    twoN=one
segment y2   t=TmN    twoN=one
segment n    t=TmN    twoN=twoNn
segment s    t=TmS    twoN=one
segment av   t=Tav    twoN=twoNav
segment nd   t=Tnd    twoN=twoNnd
segment xy   t=Txy    twoN=twoNxy
segment xynd t=Txynd  twoN=twoNxynd
segment xynds t=Txynds twoN=twoNxynd
mix    d  from d2 + mS * s
mix    y from y2 + mN * n
derive n from v
derive v from a
derive a from av
derive av from nd
derive d2 from nd
derive x from xy
derive y2 from xy
derive xy from xynd
derive nd from xynd
derive s  from xynds
derive xynd from xynds


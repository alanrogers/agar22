# (grep ^# a.lgo; pclgo a.lgo a2.legofit a2boot*.legofit; grep -v ^# a.lgo | egrep -v "\<free\>")
# Gene flow: N->Y, S->D, S->ND
# S = superarchaic; XY = early modern; ND = Neandersovan; Y = Europe;
# A, Altai; V=Vindija; D=Denisovan. Altai and Vindija on same branch
# TmN < Tv < Ta
# Neanderthal population size allowed to change
# PCA calculated with gsl_linalg_SV_decomp
# Fraction of variance:
#      pc1      pc2      pc3      pc4      pc5      pc6      pc7      pc8
#  0.22946  0.20527  0.16203  0.11515  0.08604  0.05445  0.05240  0.04005
#      pc9     pc10     pc11     pc12     pc13     pc14     pc15     pc16
#  0.02012  0.01602  0.00937  0.00596  0.00297  0.00043  0.00025  0.00002
param free [    -4,      4] pc1 = 0
param free [    -4,      4] pc2 = 0
param free [    -4,      4] pc3 = 0
param free [    -2,      2] pc4 = 0
param free [    -2,      2] pc5 = 0
param free [    -2,      2] pc6 = 0
param free [    -2,      2] pc7 = 0
param free [    -2,      2] pc8 = 0
param free [    -2,      2] pc9 = 0
param free [    -2,      2] pc10 = 0
param free [    -1,      1] pc11 = 0
param free [    -1,      1] pc12 = 0
param free [    -1,      1] pc13 = 0
param free [    -1,      1] pc14 = 0
param free [  -0.5,    0.5] pc15 = 0
param free [ -0.25,   0.25] pc16 = 0
time constrained Txynds = 69272.49803921567 - 1405.4044800753*pc1 +
    1090.480955098437*pc2 + 610.8954208329574*pc3 +
    482.1842452481195*pc4 - 1015.230307676086*pc5 -
    462.3194380384033*pc6 + 951.7304187245799*pc7 -
    582.8701969708975*pc8 - 812.8105017104494*pc9 +
    168.5830971399463*pc10 - 1606.909274066312*pc11 -
    1167.466619878102*pc12 + 2241.566112386559*pc13 +
    125.6689276945954*pc14 + 415.8010685313889*pc15 +
    68.31757615320575*pc16
time constrained Tnd = 25734.35686274509 + 31.0462942692706*pc1 +
    3.209341292335201*pc2 - 17.70755026769055*pc3 +
    57.31392658024129*pc4 - 20.07335104858268*pc5 +
    14.79121372786803*pc6 + 12.80706777774631*pc7 -
    10.19468298750342*pc8 - 2.910552805278663*pc9 -
    13.49253337447452*pc10 - 4.012968444475725*pc11 -
    3.436422185853834*pc12 - 7.105186803095886*pc13 +
    3.565885621191138*pc14 + 4.136489430149791*pc15 -
    75.38657640230029*pc16
time constrained Tav = 9343.640196078431 + 1.55522082590965*pc1 +
    191.3101627536993*pc2 - 309.0241653483857*pc3 -
    79.78697914508956*pc4 + 30.47175959796869*pc5 -
    122.0704445608575*pc6 - 73.7957304454916*pc7 -
    11.65136709213296*pc8 - 31.87377303679433*pc9 -
    53.42889840280738*pc10 + 1.422390364015163*pc11 -
    110.9906250019088*pc12 - 48.03880246926387*pc13 +
    464.4431005791563*pc14 - 89.32916060786573*pc15 +
    15.0581805535241*pc16
time constrained Txy = 2766.617999999999 + 390.6420093685559*pc1 +
    144.966522000824*pc2 + 158.0128975957157*pc3 -
    232.0725763284998*pc4 - 182.386407745419*pc5 +
    89.53258957665513*pc6 - 32.26166496926918*pc7 -
    18.51434852882374*pc8 + 4.813074849886664*pc9 -
    22.18606656182352*pc10 + 196.0715553612935*pc11 -
    249.8990847032928*pc12 + 262.5040909810265*pc13 -
    118.7931720142546*pc14 - 618.4381944885465*pc15 -
    42.90478241072505*pc16
time constrained Td = 3486.996666666666 - 11.97220965244958*pc1 -
    33.98770528327764*pc2 - 27.61431808914981*pc3 -
    18.75834661280905*pc4 - 5.405334141172118*pc5 +
    26.8871054720165*pc6 + 6.02080382481687*pc7 -
    79.99931635815865*pc8 - 40.46555582099575*pc9 +
    26.49799282615652*pc10 + 24.31552820745046*pc11 -
    2.923387979675901*pc12 - 0.3044502046897805*pc13 -
    1.746541062259712*pc14 - 0.1471262551517149*pc15 +
    0.0002175022091770351*pc16
time constrained Ta = 5269.602549019609 - 1.099384543428614*pc1 -
    28.28731925280443*pc2 - 24.45534832010836*pc3 -
    12.34038155763828*pc4 - 37.34184801390873*pc5 -
    11.23217424344461*pc6 + 9.606504502610942*pc7 +
    17.43520628947575*pc8 + 22.75087499980603*pc9 +
    29.73091605599157*pc10 - 18.5731356550438*pc11 -
    38.55302795733991*pc12 - 23.21917721612001*pc13 -
    11.72894911859186*pc14 + 0.6231024068343407*pc15 -
    0.06683893458817051*pc16
time constrained Tv = 2417.045098039216 - 4.304371035263901*pc1 -
    25.73815181160677*pc2 - 23.20813097444314*pc3 -
    16.74028982666544*pc4 - 45.8375569588304*pc5 -
    9.660799246532449*pc6 + 1.338892038302828*pc7 +
    15.02173901217857*pc8 - 6.01120701048732*pc9 -
    34.7798192063847*pc10 + 5.797460457727058*pc11 +
    43.19076958410606*pc12 + 27.30673487486208*pc13 +
    2.06437157292387*pc14 - 0.02384590848871734*pc15 +
    0.06386076644885078*pc16
twoN constrained twoNav = 19662.26862745097 + 106.6223168690113*pc1 +
    391.9148035635881*pc2 - 327.9657851328871*pc3 -
    23.00031741245241*pc4 - 5.900709140577426*pc5 +
    53.82007808028013*pc6 + 40.68972072343809*pc7 -
    70.88718261767143*pc8 + 391.8930683392986*pc9 +
    528.0451426934834*pc10 + 24.66136974807318*pc11 +
    401.6030210849993*pc12 + 268.5955445436662*pc13 -
    140.6549313563563*pc14 + 64.87170421019624*pc15 -
    8.893186026097439*pc16
twoN constrained twoNn = 4625.608235294117 - 6.455232081289884*pc1 +
    125.6494486485002*pc2 - 182.3952304162207*pc3 -
    37.83252618867519*pc4 + 58.42115256955333*pc5 -
    89.30985320376266*pc6 - 85.48422999773443*pc7 -
    15.02246054784331*pc8 - 87.27449246257389*pc9 -
    129.53485301462*pc10 - 11.7898625853471*pc11 -
    73.67116689888476*pc12 - 27.70437948107976*pc13 -
    255.1935527924763*pc14 + 35.37973476294237*pc15 -
    5.778614034301552*pc16
twoN constrained twoNnd = 392.6328333333333 - 65.73628312820813*pc1 -
    3.98561037511301*pc2 + 39.32188276440235*pc3 -
    122.92182683377*pc4 + 38.61392850072189*pc5 -
    34.76982780184117*pc6 - 26.93245111751783*pc7 +
    21.5843117094416*pc8 + 0.9301280178649407*pc9 +
    29.43519424839985*pc10 + 7.40076324805717*pc11 +
    5.937738214258299*pc12 + 12.62991537924707*pc13 +
    5.258977347041119*pc14 + 12.45582895634158*pc15 -
    160.7565177897887*pc16
twoN constrained twoNxy = 51651.28039215687 - 1190.637560709296*pc1 -
    582.1581233556054*pc2 - 525.0371987414131*pc3 +
    844.7407795995817*pc4 + 742.3354928889187*pc5 -
    299.268115829973*pc6 + 63.31836705580119*pc7 +
    144.4481057144084*pc8 - 112.5800408133215*pc9 +
    290.3043776160798*pc10 - 848.5765301612074*pc11 +
    669.6386381666543*pc12 - 119.5957486696728*pc13 -
    304.5353669617442*pc14 - 2141.065277563419*pc15 -
    168.3042053052445*pc16
twoN constrained twoNxynd = 41908.92156862745 +
    199.8786624663096*pc1 - 23.13931559842067*pc2 +
    20.89429651273134*pc3 - 14.93817718691557*pc4 +
    3.630639079386071*pc5 - 89.15451230729171*pc6 -
    65.34379926105169*pc7 + 97.89272777048883*pc8 -
    287.595551325646*pc9 + 174.87175808985*pc10 -
    141.7005936203215*pc11 + 87.69792039784203*pc12 -
    8.037588028503325*pc13 + 13.65651315906856*pc14 +
    22.79292659395876*pc15 + 8.272133847573784*pc16
twoN constrained twoNs = 1782415.058823529 - 117325.1167845304*pc1 -
    90227.21743606373*pc2 + 179164.7419046267*pc3 +
    351496.362123307*pc4 - 279317.5222899034*pc5 -
    371986.8508927139*pc6 - 889094.4988500124*pc7 -
    226434.8767764854*pc8 + 147798.2723571162*pc9 +
    159628.1813101071*pc10 + 184100.8426212594*pc11 -
    49354.06614280414*pc12 + 105188.6635495233*pc13 +
    20442.85398897307*pc14 + 14478.5844933373*pc15 +
    3975.210464289599*pc16
mixFrac constrained mN = 0.01919410588235294 - 0.0001894632274095723*pc1 +
    0.0001262265390216165*pc2 - 7.198486509789211e-05*pc3 -
    5.872775641368774e-05*pc4 - 0.0001445626987512616*pc5 +
    0.0007086264541822905*pc6 - 0.0003934793778173625*pc7 +
    0.0002247850396685426*pc8 - 0.0001006290837969355*pc9 +
    8.595508170171312e-06*pc10 - 0.0002017188500013557*pc11 -
    2.369285837580746e-05*pc12 - 3.640468070079001e-05*pc13 +
    1.46442647562749e-05*pc14 - 1.02868734863137e-06*pc15 -
    1.87630369364977e-06*pc16
mixFrac constrained mS = 0.03303001372549019 + 0.001366925351895458*pc1 -
    0.001151244661706317*pc2 - 0.0001288256219028016*pc3 -
    0.0007503969539073592*pc4 + 0.001050652343371541*pc5 +
    0.0002157242325778353*pc6 - 0.0008162656846607222*pc7 -
    0.001352817348237559*pc8 + 0.001396511335462033*pc9 -
    0.000960526495704535*pc10 - 0.002521788528955288*pc11 -
    2.772158850784029e-05*pc12 + 0.0008337859330975519*pc13 +
    0.0001952204241422974*pc14 + 0.0002217370789518242*pc15 -
    2.315952662334145e-05*pc16
mixFrac constrained mSND = 0.03308308235294118 +
    0.0002569412827944006*pc1 - 0.002372773571923328*pc2 -
    0.001724575757143516*pc3 + 0.001131232518625015*pc4 +
    0.002488440486854014*pc5 + 0.0006227924836905485*pc6 -
    0.000313675156046823*pc7 + 0.002269871095643696*pc8 -
    0.0002496048556534594*pc9 + 0.0006483323754298817*pc10 +
    0.001846294716007053*pc11 - 0.001891135046987991*pc12 +
    0.003554498028150375*pc13 + 0.0001627916033302767*pc14 +
    0.0008495452620926776*pc15 - 2.990210596752938e-05*pc16
time fixed  zero = 0
twoN fixed  one = 1
time fixed  TmN = 1        # no coalesc. events can happen b/t 0 and Tv
time fixed  Txynd = 25920  # \citet[table~S12.2, p.~90]{Li:N-505-43-S88}
time constrained TmS = 0.5*(Td + Tnd)
time constrained TmSND = 0.5*(Tnd + Txynd)
segment x    t=zero   twoN=one     samples=1
segment y    t=zero   twoN=one     samples=1
segment v    t=Tv     twoN=twoNn   samples=1
segment a    t=Ta     twoN=twoNn   samples=1
segment d    t=Td     twoN=one     samples=1
segment d2   t=TmS    twoN=one
segment y2   t=TmN    twoN=one
segment n    t=TmN    twoN=twoNn
segment s    t=TmS    twoN=twoNs
segment s2   t=TmSND  twoN=twoNs
segment av   t=Tav    twoN=twoNav
segment nd   t=Tnd    twoN=twoNnd
segment nd2  t=TmSND  twoN=twoNnd
segment xy   t=Txy    twoN=twoNxy
segment xynd t=Txynd  twoN=twoNxynd
segment xynds t=Txynds twoN=twoNxynd
mix    d    from d2 + mS * s
mix    y    from y2 + mN * n
mix    nd   from nd2 + mSND * s2
derive n    from v
derive v    from a
derive a    from av
derive av   from nd
derive d2   from nd
derive x    from xy
derive y2   from xy
derive xy   from xynd
derive nd2  from xynd
derive s    from s2
derive s2   from xynds
derive xynd from xynds


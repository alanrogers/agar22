# (grep ^# a.lgo; pclgo a.lgo a2.legofit a2boot*.legofit; grep -v ^# a.lgo | egrep -v "\<free\>")
# Gene flow: N->Y, XY->N
# S = superarchaic; XY = early modern; Y = Europe; N=Neanderthal; D=Denisovan
# Altai and Vindija on same branch
# TmN < Tv < Ta
# Neanderthal population size allowed to change
# PCA calculated with gsl_linalg_SV_decomp
# Fraction of variance:
#      pc1      pc2      pc3      pc4      pc5      pc6      pc7      pc8
#  0.21598  0.20727  0.16901  0.11128  0.07893  0.07483  0.05746  0.05113
#      pc9     pc10     pc11     pc12     pc13
#  0.02457  0.00502  0.00358  0.00091  0.00002
param free [    -4,      4] pc1 = 0
param free [    -4,      4] pc2 = 0
param free [    -4,      4] pc3 = 0
param free [    -2,      2] pc4 = 0
param free [    -2,      2] pc5 = 0
param free [    -2,      2] pc6 = 0
param free [    -2,      2] pc7 = 0
param free [    -2,      2] pc8 = 0
param free [    -2,      2] pc9 = 0
param free [    -1,      1] pc10 = 0
param free [    -1,      1] pc11 = 0
param free [    -1,      1] pc12 = 0
param free [ -0.25,   0.25] pc13 = 0
time constrained Tnd = 25856.23529411764 + 0.3800321939701586*pc1 -
    7.678191386078599*pc2 + 16.10986446053139*pc3 +
    9.831961249603141*pc4 - 0.4107451343338356*pc5 -
    2.814151653465304*pc6 + 4.075606275144216*pc7 -
    0.7171393582680188*pc8 + 1.793767520305162*pc9 -
    1.483377374639961*pc10 - 0.06769719595861134*pc11 +
    0.08439358678212582*pc12 + 21.10190880058219*pc13
time constrained Tav = 18907.51568627452 + 98.73945378492473*pc1 +
    230.873932418872*pc2 + 67.41700095527706*pc3 +
    71.93415213357225*pc4 + 32.65721746047625*pc5 +
    21.71861375487099*pc6 - 15.1258890342357*pc7 +
    39.67393676887492*pc8 + 38.23172359874749*pc9 -
    100.4976268999465*pc10 + 319.1613185795341*pc11 -
    87.45575239554252*pc12 - 3.895287393890662*pc13
time constrained Txy = 9505.688823529414 + 143.3933107300822*pc1 -
    73.35624603480976*pc2 + 53.28550934740085*pc3 -
    136.3236431237421*pc4 + 8.792135413507992*pc5 +
    49.34692451801144*pc6 + 9.468393400406631*pc7 -
    19.39410210435613*pc8 - 33.37209014190757*pc9 -
    40.84891505749277*pc10 - 45.83874710356514*pc11 -
    232.5780629844978*pc12 - 1.424289717368309*pc13
time constrained Td = 2957.753921568627 - 19.09692138638185*pc1 +
    13.6840581467024*pc2 + 20.97537024133447*pc3 -
    0.06601772016665018*pc4 - 69.34937460555113*pc5 +
    21.49439322629266*pc6 - 47.88809248551307*pc7 -
    43.66212531119025*pc8 - 23.16446865909756*pc9 -
    4.265779294260958*pc10 + 0.8054744208165887*pc11 -
    3.703032791956322*pc12 + 0.3090086213720774*pc13
time constrained Ta = 4948.926274509804 - 31.90132775721957*pc1 +
    27.53722489492002*pc2 + 27.75889878958287*pc3 -
    30.88515973215778*pc4 + 30.33007878645972*pc5 +
    10.50231150179043*pc6 + 4.918939360888737*pc7 -
    16.19150064279608*pc8 + 14.76769671067696*pc9 -
    59.74032391941432*pc10 - 27.07877549393091*pc11 +
    14.75293613433075*pc12 - 1.317532549990878*pc13
time constrained Tv = 2215.251764705882 - 36.39607345167674*pc1 +
    31.08094594462698*pc2 + 36.83568808224309*pc3 -
    25.4884823012166*pc4 + 22.05735965915785*pc5 +
    30.68626538524736*pc6 + 19.54368852728464*pc7 -
    3.633790649871615*pc8 - 1.045476423654592*pc9 +
    77.37918660577179*pc10 + 4.256286126914345*pc11 -
    14.71142576545811*pc12 + 1.943234999485424*pc13
twoN constrained twoNav = 75292.18431372548 + 4535.430943484003*pc1 +
    2482.785288843831*pc2 - 259.378129877802*pc3 +
    2817.006140687676*pc4 + 7578.578200482521*pc5 -
    4734.376127234337*pc6 - 4553.926128626164*pc7 -
    9675.806668039859*pc8 - 2593.285832054145*pc9 +
    2757.382776656013*pc10 - 1934.603061721778*pc11 +
    474.0239239981535*pc12 + 180.2339948645611*pc13
twoN constrained twoNn = 7363.013725490196 + 27.33001435247307*pc1 +
    33.59755779375173*pc2 + 17.41909590260693*pc3 +
    17.55239715660628*pc4 + 2.093395687133726*pc5 +
    14.88239881394385*pc6 - 12.87407954910113*pc7 +
    46.84227021502251*pc8 - 44.49145739861566*pc9 -
    0.1840495591712131*pc10 - 39.24462500091883*pc11 +
    12.9137677076852*pc12 - 0.04836286802134062*pc13
twoN constrained twoNnd = 150.24424 - 1.758887681001868*pc1 +
    17.67111935399266*pc2 - 38.0074134096044*pc3 -
    23.36202303404524*pc4 + 1.238612671288897*pc5 +
    6.12472571341211*pc6 - 9.347344892335753*pc7 +
    2.625286805769128*pc8 - 5.411895895388791*pc9 +
    0.6558085234367571*pc10 + 0.9932421617903446*pc11 -
    0.7636679054879348*pc12 + 49.61044529458504*pc13
twoN constrained twoNxy = 30040.91960784315 - 336.4691390534125*pc1 +
    152.8436526022035*pc2 - 123.778891505503*pc3 +
    318.954632923052*pc4 + 14.82637656551656*pc5 -
    192.6660618396319*pc6 - 111.9503596318652*pc7 +
    113.8248805232256*pc8 + 125.307319796681*pc9 -
    30.01122468991768*pc10 - 220.1180009306317*pc11 -
    494.6348523642558*pc12 - 3.843813535621639*pc13
twoN constrained twoNxynd = 42026.96666666668 -
    6.775823914477754*pc1 - 15.06223867019237*pc2 +
    71.54322057121317*pc3 - 105.7677216861851*pc4 +
    2.110583600567846*pc5 - 137.6819946563899*pc6 -
    142.6880794165868*pc7 + 89.49303885534842*pc8 +
    45.81866816992805*pc9 + 31.36824317889328*pc10 +
    22.84371653615793*pc11 + 19.96955185780555*pc12 -
    0.1132976729822014*pc13
mixFrac constrained mN = 0.01930867254901961 + 5.489351725029401e-06*pc1 -
    0.0002814899842364138*pc2 - 3.923178473386616e-05*pc3 +
    0.0001920932095996579*pc4 + 0.0003149560068272275*pc5 +
    0.000606146491535792*pc6 - 0.0005344684793544216*pc7 +
    0.0001043278627205335*pc8 + 0.0003149662259225657*pc9 +
    1.493516261468906e-05*pc10 + 2.957734722164635e-05*pc11 +
    2.695934345445781e-05*pc12 + 5.928683878514633e-06*pc13
mixFrac constrained mXY = 0.06206167843137254 +
    0.002510712745803702*pc1 + 0.0019680101364839*pc2 +
    7.206725854633167e-05*pc3 + 7.988731085721016e-05*pc4 -
    0.001829662741989237*pc5 + 0.0001561150455201046*pc6 +
    0.0005101681473443725*pc7 - 0.0004978368073307179*pc8 +
    0.004332873279743453*pc9 + 0.0009587103948498092*pc10 -
    0.002039985422123127*pc11 + 0.0005342692727212763*pc12 +
    0.0001387779347532951*pc13
time fixed  zero = 0
twoN fixed  one = 1
time fixed  TmN = 1        # no coalesc. events can happen b/t 0 and Tv
time fixed  Txynd = 25920  # \citet[table~S12.2, p.~90]{Li:N-505-43-S88}
time constrained TmXY = 0.5*(Txy + Tav)
segment x    t=zero   twoN=one     samples=1
segment y    t=zero   twoN=one     samples=1
segment v    t=Tv     twoN=twoNn   samples=1
segment a    t=Ta     twoN=twoNn   samples=1
segment a2   t=TmXY   twoN=twoNn
segment d    t=Td     twoN=one     samples=1
segment y2   t=TmN    twoN=one
segment n    t=TmN    twoN=twoNn
segment av   t=Tav    twoN=twoNav
segment nd   t=Tnd    twoN=twoNnd
segment xy   t=Txy    twoN=twoNxy
segment xy2  t=TmXY   twoN=twoNxy
segment xynd t=Txynd  twoN=twoNxynd
mix    y from y2 + mN * n
mix    a from a2 + mXY * xy2
derive n from v
derive v from a
derive a2 from av
derive av from nd
derive d  from nd
derive x  from xy
derive y2 from xy
derive xy from xy2
derive xy2 from xynd
derive nd from xynd


# (grep ^# a.lgo; pclgo a.lgo a2.legofit a2boot*.legofit; grep -v ^# a.lgo | egrep -v "\<free\>")
# Gene flow: N->Y, XY->N, S->ND
# S = superarchaic; XY = early modern; ND = Neandersovan; Y = Europe;
# A, Altai; V=Vindija; D=Denisovan. Altai and Vindija on same branch
# TmN < Tv < Ta
# Neanderthal population size allowed to change
# PCA calculated with gsl_linalg_SV_decomp
# Fraction of variance:
#      pc1      pc2      pc3      pc4      pc5      pc6      pc7      pc8
#  0.33690  0.16719  0.10065  0.08921  0.08414  0.06623  0.05274  0.04190
#      pc9     pc10     pc11     pc12     pc13     pc14     pc15
#  0.03361  0.01258  0.00769  0.00483  0.00187  0.00041  0.00002
param free [    -4,      4] pc1 = 0
param free [    -2,      2] pc2 = 0
param free [    -2,      2] pc3 = 0
param free [    -2,      2] pc4 = 0
param free [    -2,      2] pc5 = 0
param free [    -2,      2] pc6 = 0
param free [    -2,      2] pc7 = 0
param free [    -2,      2] pc8 = 0
param free [    -2,      2] pc9 = 0
param free [    -1,      1] pc10 = 0
param free [    -1,      1] pc11 = 0
param free [    -1,      1] pc12 = 0
param free [    -1,      1] pc13 = 0
param free [  -0.5,    0.5] pc14 = 0
param free [  -0.5,    0.5] pc15 = 0
time constrained Txynds = 115147.8607843137 - 963.4455124087432*pc1 +
    2414.747551825934*pc2 + 2980.12422887674*pc3 +
    487.4797504990166*pc4 + 2266.174140447344*pc5 +
    293.7670526810417*pc6 + 731.4760907146842*pc7 +
    971.4721164307756*pc8 - 799.4579682096138*pc9 -
    1403.213665389459*pc10 - 3541.765511198373*pc11 +
    2054.934988543179*pc12 - 992.3822472446843*pc13 +
    402.34460380539*pc14 - 33.6422498254551*pc15
time constrained Tnd = 25641.85882352942 - 43.48842875312806*pc1 +
    7.442241050283059*pc2 - 44.21022847806271*pc3 +
    26.96663027657894*pc4 + 48.68002447223603*pc5 +
    2.227541997458233*pc6 + 7.714855787309632*pc7 -
    40.39936471967928*pc8 - 10.92791707066833*pc9 -
    3.228490093989509*pc10 + 9.187080497068377*pc11 -
    2.444886180000325*pc12 - 5.09036047817603*pc13 -
    6.314380740675532*pc14 - 93.72510990660906*pc15
time constrained Tav = 20611.74117647059 - 54.67300142445951*pc1 -
    222.5562433264862*pc2 + 165.1116359106724*pc3 +
    116.4789386238826*pc4 + 14.7867496017407*pc5 +
    26.08757715921757*pc6 - 25.21492449535669*pc7 -
    18.14315905548083*pc8 - 10.6570120581255*pc9 -
    105.6734339757857*pc10 + 141.9951348033451*pc11 +
    12.21641368004729*pc12 - 277.0988952703759*pc13 -
    56.37232133596446*pc14 + 14.70136743343532*pc15
time constrained Txy = 3662.420196078432 - 267.9596602887243*pc1 -
    44.78365186466061*pc2 - 26.59241291107492*pc3 -
    228.1109555535874*pc4 - 128.1854763984093*pc5 +
    39.85023674552709*pc6 + 104.6321435025219*pc7 -
    64.63207710037214*pc8 + 143.2586574521093*pc9 +
    84.53227167154398*pc10 - 207.2088072243201*pc11 -
    30.91296159301709*pc12 - 72.31579348363734*pc13 -
    502.7204612709513*pc14 + 37.20588457241107*pc15
time constrained Td = 3021.918431372548 + 7.370969706461595*pc1 -
    27.86280852707991*pc2 - 35.62961310254278*pc3 +
    19.86930458584327*pc4 + 15.76339446729584*pc5 +
    39.00021018088194*pc6 + 34.12452165144859*pc7 +
    64.27925366729754*pc8 - 0.3224648044128294*pc9 +
    5.161009423683276*pc10 - 17.39976726921365*pc11 -
    11.55278000565041*pc12 - 5.901795815368339*pc13 -
    1.163174327312025*pc14 - 0.03851211878824066*pc15
time constrained Ta = 5026.746666666666 + 24.54283173344406*pc1 -
    20.55453242393906*pc2 + 8.755842671580114*pc3 -
    34.12470996786347*pc4 + 29.42672370809585*pc5 +
    15.16035418570736*pc6 + 3.777054288723106*pc7 -
    25.52211760779096*pc8 + 3.028688405764993*pc9 -
    33.35895250055599*pc10 - 20.21038707961798*pc11 -
    48.05405585549924*pc12 + 5.484225297891509*pc13 +
    7.232129003229471*pc14 - 0.7288927949578947*pc15
time constrained Tv = 2318.100588235295 + 22.73026765583219*pc1 -
    30.7272500503695*pc2 + 8.736443751994845*pc3 -
    28.92185920477661*pc4 + 29.49430844912971*pc5 +
    14.00538781774118*pc6 + 21.28592483813699*pc7 -
    19.50406826155428*pc8 - 13.73449610101498*pc9 +
    37.48363274879866*pc10 + 10.14506333282617*pc11 +
    50.96658643882024*pc12 + 9.664329698266219*pc13 -
    2.506394823840398*pc14 + 0.00110841129177466*pc15
twoN constrained twoNav = 200802.2549019608 - 11731.09838527617*pc1 +
    2249.064366089475*pc2 + 7181.776309343544*pc3 +
    347.544365192228*pc4 - 5100.625843753191*pc5 +
    45172.81944031223*pc6 - 36091.09673669972*pc7 -
    2996.657035913442*pc8 - 14026.58330808266*pc9 +
    13749.61922823693*pc10 - 2982.587154334961*pc11 -
    4211.119493450007*pc12 + 5497.355326044537*pc13 +
    2253.304465345638*pc14 - 391.6349999605872*pc15
twoN constrained twoNn = 7335.248431372551 - 19.00300693893399*pc1 -
    33.19643343096804*pc2 + 25.12036310632184*pc3 +
    25.2318686391866*pc4 - 14.80642112266509*pc5 -
    25.87432079420662*pc6 + 16.80944127376714*pc7 -
    8.594320229648641*pc8 - 39.9087183545557*pc9 +
    30.62697481338079*pc10 - 28.1478697891841*pc11 -
    27.85184183828001*pc12 + 23.82329211155747*pc13 +
    10.15023828766353*pc14 - 2.037368091300447*pc15
twoN constrained twoNnd = 563.6212960784313 + 88.96760038586525*pc1 -
    12.42225081105348*pc2 + 90.98762541339543*pc3 -
    57.4674748816033*pc4 - 96.82626264347279*pc5 -
    5.192704596370074*pc6 - 15.40761687487753*pc7 +
    83.77784023372237*pc8 + 19.1690678386585*pc9 +
    7.286264087671386*pc10 - 11.58992111255506*pc11 +
    2.47829059144068*pc12 - 3.289441280307267*pc13 -
    17.16622867966067*pc14 - 191.866502197191*pc15
twoN constrained twoNxy = 47199.52352941176 + 802.9371369989167*pc1 +
    101.7746165433246*pc2 + 52.52138436012304*pc3 +
    705.6198317963207*pc4 + 368.5244927374507*pc5 -
    144.5644372221763*pc6 - 396.4939033496983*pc7 +
    95.465039801719*pc8 - 657.7459853592117*pc9 -
    454.0522862181439*pc10 + 163.1407071113347*pc11 +
    47.48843378556266*pc12 + 694.8335858538925*pc13 -
    1387.406800862403*pc14 + 90.76908466370605*pc15
twoN constrained twoNxynd = 39805.92549019608 -
    79.91253571446786*pc1 - 30.99289434993084*pc2 -
    78.01630891262624*pc3 - 155.5505910421589*pc4 -
    34.29491086668264*pc5 - 50.77568516579396*pc6 -
    28.91129940951847*pc7 + 78.20057185573881*pc8 -
    212.3540488523233*pc9 - 116.955386247602*pc10 +
    28.67407720739948*pc11 + 44.40471980791022*pc12 -
    14.0862044422196*pc13 + 16.13391887272505*pc14 +
    1.675613416547701*pc15
mixFrac constrained mN = 0.0199269431372549 + 0.000126397877246837*pc1 +
    0.0002178630509987335*pc2 - 8.464828775275842e-07*pc3 +
    0.0001413741343384807*pc4 - 0.0004746061568646228*pc5 +
    0.000409603803924084*pc6 + 0.0005601440315727609*pc7 -
    0.0003400829979811762*pc8 - 0.0002361611691465771*pc9 -
    0.0002592656292751038*pc10 + 8.311598111237384e-05*pc11 +
    6.571116420558238e-05*pc12 - 6.067924283411567e-06*pc13 +
    1.443327704830918e-05*pc14 - 2.091615486421513e-06*pc15
mixFrac constrained mSND = 0.02070508039215687 +
    0.000599463816042983*pc1 - 0.0007551183485515261*pc2 -
    0.0009125905685666216*pc3 + 0.0004379098243077377*pc4 -
    0.0006129250512158979*pc5 - 0.000177767949673998*pc6 -
    0.0007307978397748599*pc7 - 0.0006183053424132427*pc8 +
    0.0001460590045631276*pc9 - 0.0003715461560934729*pc10 -
    0.001381891533203307*pc11 + 0.0008280792797720505*pc12 -
    0.0003965984812682376*pc13 + 0.0002178855083183665*pc14 -
    5.228534917330915e-05*pc15
mixFrac constrained mXY = 0.06278927647058824 -
    0.002461880644835336*pc1 - 0.002306726456929737*pc2 +
    0.001024793765697209*pc3 + 0.0004552621643835363*pc4 -
    0.0004295895473098988*pc5 + 0.0007139298328372165*pc6 +
    0.0001284148407177406*pc7 + 0.0004684354946836098*pc8 +
    0.002471666032740379*pc9 - 0.002979640238312074*pc10 +
    0.0005315269963219175*pc11 + 0.001914236068120666*pc12 +
    0.004404064009742918*pc13 + 0.0006037748211977449*pc14 -
    0.0002540125770735819*pc15
time fixed  zero = 0
twoN fixed  one = 1
time fixed  TmN = 1        # no coalesc. events can happen b/t 0 and Tv
time fixed  Txynd = 25920  # \citet[table~S12.2, p.~90]{Li:N-505-43-S88}
twoN fixed  twoNs = 2000
time constrained TmXY = 0.5*(Txy + Tav)
time constrained TmSND = 0.5*(Tnd + Txynd)
segment x    t=zero   twoN=one     samples=1
segment y    t=zero   twoN=one     samples=1
segment v    t=Tv     twoN=twoNn   samples=1
segment a    t=Ta     twoN=twoNn   samples=1
segment a2   t=TmXY   twoN=twoNn
segment d    t=Td     twoN=one     samples=1
segment y2   t=TmN    twoN=one
segment n    t=TmN    twoN=twoNn
segment s    t=TmSND  twoN=twoNs
segment av   t=Tav    twoN=twoNav
segment nd   t=Tnd    twoN=twoNnd
segment nd2  t=TmSND  twoN=twoNnd
segment xy   t=Txy    twoN=twoNxy
segment xy2  t=TmXY   twoN=twoNxy
segment xynd t=Txynd  twoN=twoNxynd
segment xynds t=Txynds twoN=twoNxynd
mix    y    from y2 + mN * n
mix    a    from a2 + mXY * xy2
mix    nd   from nd2 + mSND * s
derive n    from v
derive v    from a
derive a2   from av
derive av   from nd
derive d   from nd
derive x    from xy
derive y2   from xy
derive xy   from xy2
derive xy2  from xynd
derive nd2  from xynd
derive s   from xynds
derive xynd from xynds


# (grep ^# a.lgo; pclgo a.lgo a2.legofit a2boot*.legofit; grep -v ^# a.lgo | egrep -v "\<free\>")
# Gene flow: N->Y, S->D, XY->N, S->ND
# S = superarchaic; XY = early modern; ND = Neandersovan; Y = Europe;
# A, Altai; V=Vindija; D=Denisovan. Altai and Vindija on same branch
# TmN < Tv < Ta
# PCA calculated with gsl_linalg_SV_decomp
# Fraction of variance:
#      pc1      pc2      pc3      pc4      pc5      pc6      pc7      pc8
#  0.28084  0.19699  0.12005  0.10019  0.08207  0.05532  0.04550  0.03952
#      pc9     pc10     pc11     pc12     pc13     pc14     pc15     pc16
#  0.02911  0.02117  0.01038  0.00804  0.00623  0.00235  0.00184  0.00036
#     pc17
#  0.00003
param free [    -4,      4] pc1 = 0
param free [    -4,      4] pc2 = 0
param free [    -2,      2] pc3 = 0
param free [    -2,      2] pc4 = 0
param free [    -2,      2] pc5 = 0
param free [    -2,      2] pc6 = 0
param free [    -2,      2] pc7 = 0
param free [    -2,      2] pc8 = 0
param free [    -2,      2] pc9 = 0
param free [    -2,      2] pc10 = 0
param free [    -2,      2] pc11 = 0
param free [    -1,      1] pc12 = 0
param free [    -1,      1] pc13 = 0
param free [    -1,      1] pc14 = 0
param free [    -1,      1] pc15 = 0
param free [  -0.5,    0.5] pc16 = 0
param free [  -0.5,    0.5] pc17 = 0
time constrained Txynds = 73418.15686274511 + 1352.511011674299*pc1 +
    95.31895346595168*pc2 - 900.7379403146253*pc3 +
    255.423130094536*pc4 + 1064.085297708344*pc5 -
    797.3798722412778*pc6 + 358.6062844729197*pc7 +
    287.0839764352025*pc8 + 191.6011631215478*pc9 -
    1045.341059086127*pc10 + 265.1116702274505*pc11 +
    76.48667645127972*pc12 + 1486.75473922567*pc13 -
    979.0572774057243*pc14 + 2137.808071739978*pc15 +
    254.4575965497594*pc16 + 6.021144633089983*pc17
time constrained Tnd = 25325.23921568628 - 83.22877809010346*pc1 -
    21.31453821121501*pc2 - 112.6212786913815*pc3 +
    66.21743723159472*pc4 + 8.685499140884991*pc5 -
    23.64789014591682*pc6 - 27.30181867736012*pc7 +
    30.52426148675176*pc8 - 14.26484717430072*pc9 +
    39.98158331323726*pc10 + 2.160967459870937*pc11 -
    68.26490898360716*pc12 + 31.53946157110165*pc13 +
    45.17916846565392*pc14 + 8.002662153659264*pc15 -
    9.990401192968388*pc16 + 186.749571006553*pc17
time constrained Tav = 13204.15882352942 - 96.63575300969725*pc1 +
    615.9757458424459*pc2 + 35.89627293983904*pc3 +
    76.67215094373209*pc4 + 115.0433344601353*pc5 -
    9.176339643544205*pc6 + 68.66608021009655*pc7 -
    58.11542370569846*pc8 + 185.49507879507*pc9 -
    2.54388096721116*pc10 + 117.7041981088311*pc11 +
    38.33489224860598*pc12 - 24.70898186214114*pc13 +
    306.9692625342951*pc14 - 8.549201036262337*pc15 +
    904.0165769443695*pc16 + 40.72502042594226*pc17
time constrained Txy = 253.217404117647 + 23.27763659406609*pc1 -
    25.85233245138313*pc2 + 18.27264390006499*pc3 +
    142.4421559035309*pc4 - 27.68079696108856*pc5 +
    70.21742704789369*pc6 + 7.603816062007466*pc7 -
    30.80820572058851*pc8 + 31.70042241282236*pc9 +
    17.92886699656147*pc10 + 34.65808889514602*pc11 +
    46.5331304239895*pc12 + 92.64777711045964*pc13 -
    46.46435132525485*pc14 - 67.44800381291044*pc15 +
    13.76597310062953*pc16 - 1.32532012918188*pc17
time constrained Td = 3554.491960784313 - 26.09444868140248*pc1 -
    12.41163480192864*pc2 - 12.4255973362054*pc3 -
    11.12658604380231*pc4 + 43.84604435787676*pc5 -
    1.319726379764956*pc6 - 70.44773836925637*pc7 -
    61.97434911368647*pc8 + 9.847963760996072*pc9 -
    22.47860405649381*pc10 + 20.116776331831*pc11 +
    27.72432105635643*pc12 - 7.354864574608592*pc13 -
    11.06317140810443*pc14 - 4.392271924475138*pc15 +
    0.4853011967375392*pc16 + 0.629154601023566*pc17
time constrained Ta = 5295.225686274509 - 27.56895440972371*pc1 -
    10.00111790444182*pc2 + 17.17472306448235*pc3 +
    7.808920530020628*pc4 + 40.70795497489028*pc5 +
    9.083815603482808*pc6 + 18.36741858049394*pc7 +
    20.91288529473997*pc8 + 11.00735978750492*pc9 -
    3.885722937324332*pc10 - 32.63003304998806*pc11 +
    43.60355899765065*pc12 + 11.05838559417165*pc13 +
    31.3219835136509*pc14 + 9.197359062712954*pc15 -
    12.73914339772575*pc16 + 0.1528387214416745*pc17
time constrained Tv = 2469.289607843137 - 23.10903485208171*pc1 -
    5.131351335656189*pc2 + 25.34900418572605*pc3 +
    2.501676906694561*pc4 + 48.75139649353752*pc5 +
    23.47604686994117*pc6 + 12.65520290977092*pc7 +
    21.76522346936646*pc8 - 16.2524618711501*pc9 -
    5.137951258346496*pc10 + 19.87027627607655*pc11 -
    39.19205803666681*pc12 - 9.956093076480856*pc13 -
    38.28698474374292*pc14 - 9.162398722680539*pc15 +
    9.332547569946602*pc16 - 0.348639984897739*pc17
twoN constrained twoNav = 18688.56078431372 - 316.5325654491695*pc1 +
    980.6684311514066*pc2 - 501.7557048147075*pc3 +
    220.2706489762278*pc4 + 157.9459494610114*pc5 -
    296.5635341905956*pc6 + 325.1542500692954*pc7 +
    53.31156414735051*pc8 + 1344.695187527415*pc9 +
    454.2110144392641*pc10 - 231.3666833238543*pc11 +
    168.295598350617*pc12 - 656.0390195000136*pc13 -
    990.0762666435521*pc14 - 124.2162221098746*pc15 -
    678.5338005188885*pc16 - 26.89995472693191*pc17
twoN constrained twoNn = 6389.893725490194 - 26.78394957783244*pc1 +
    138.8792227307152*pc2 + 38.32828358947107*pc3 +
    1.262741112816866*pc4 + 3.775264158855262*pc5 +
    20.7339613079543*pc6 + 22.46919140812243*pc7 -
    27.75159373041997*pc8 - 28.63673896956292*pc9 -
    39.44056005700366*pc10 + 138.9283044883436*pc11 -
    21.00468762308527*pc12 + 62.18797066916166*pc13 +
    89.07838279445703*pc14 + 13.88604160447291*pc15 -
    142.4409702309643*pc16 - 6.445789389869163*pc17
twoN constrained twoNnd = 1189.663803921569 + 177.2873708213104*pc1 +
    38.51354120606796*pc2 + 217.7169029703379*pc3 -
    128.9683470647125*pc4 - 10.65086286586154*pc5 +
    42.50443164717047*pc6 + 61.98004173016422*pc7 -
    56.4750111666544*pc8 + 30.44348514507681*pc9 -
    88.73337033011119*pc10 + 2.792205150480852*pc11 +
    129.0445561530774*pc12 - 61.17555121622091*pc13 -
    89.09227491769063*pc14 - 37.26914741105433*pc15 -
    13.03566348539051*pc16 + 385.8494867891865*pc17
twoN constrained twoNxy = 59994.97254901963 - 297.6729248723003*pc1 +
    87.01384584762718*pc2 - 102.1960466354107*pc3 -
    404.8259911960764*pc4 - 133.1643222841993*pc5 -
    219.9224734265991*pc6 + 44.0502436542811*pc7 +
    178.5057669937765*pc8 - 64.70715664433499*pc9 -
    161.6006781269616*pc10 - 32.04172743505691*pc11 +
    145.4863893969132*pc12 + 493.3880254475523*pc13 -
    246.0998962094866*pc14 - 396.4906712369385*pc15 +
    74.47063392111576*pc16 - 4.820222825496989*pc17
twoN constrained twoNxynd = 40871.8705882353 - 119.2388258311544*pc1 -
    33.3224712209669*pc2 + 19.18439862417712*pc3 +
    123.9420509483726*pc4 - 139.8884605662859*pc5 -
    38.37512094661518*pc6 + 17.26603206952937*pc7 +
    50.68359332197588*pc8 + 29.57279513762382*pc9 -
    306.123030056647*pc10 + 12.88239229722303*pc11 +
    7.21137288580769*pc12 - 116.2678218797955*pc13 -
    16.87648176144262*pc14 + 33.31924932678545*pc15 +
    12.00958647552021*pc16 - 0.2178057715942971*pc17
twoN constrained twoNs = 1248994.980392157 - 45221.59165531739*pc1 +
    18992.85497652804*pc2 - 300585.000358583*pc3 -
    45188.34192283241*pc4 + 19975.32606111567*pc5 +
    200375.4382851564*pc6 + 340429.907361366*pc7 -
    245665.858060706*pc8 - 238680.0502614405*pc9 -
    58250.1459295328*pc10 - 30601.26683627615*pc11 +
    117551.8728265551*pc12 - 102038.606230361*pc13 -
    49025.95543465268*pc14 - 13865.92870087944*pc15 +
    17402.3440968202*pc16 - 684.4964130325258*pc17
mixFrac constrained mN = 0.0189994725490196 + 9.542205771488186e-05*pc1 +
    4.744258179041159e-05*pc2 - 0.0002427468427754936*pc3 -
    0.0002524824339337313*pc4 - 7.937805250715452e-05*pc5 +
    0.0006720462179427752*pc6 - 0.0002190052867420171*pc7 +
    0.0002389190317552555*pc8 + 0.0002913717385187979*pc9 -
    0.0001869436114622527*pc10 - 7.820300882863372e-05*pc11 -
    0.0001071451442847006*pc12 + 7.510984934580444e-05*pc13 +
    7.258802705428767e-05*pc14 + 3.843372201950117e-05*pc15 -
    9.992447612260437e-06*pc16 + 3.899626714176405e-07*pc17
mixFrac constrained mS = 0.02542750000000001 - 0.0009579511817386995*pc1 -
    0.000582658787027079*pc2 + 0.0008389345126058377*pc3 -
    0.0005211797634050616*pc4 - 0.0004821990571264523*pc5 +
    0.0001487624140946323*pc6 + 0.0008635113709649434*pc7 -
    0.001702950928003532*pc8 + 0.001211195217226284*pc9 +
    3.643416047957606e-05*pc10 - 0.000688082566628743*pc11 -
    0.00134137773994092*pc12 + 0.0009418283137268313*pc13 +
    5.19104170068672e-05*pc14 + 0.0008258191448566235*pc15 +
    0.0001052941160925651*pc16 + 4.41207383300221e-05*pc17
mixFrac constrained mSND = 0.0452448431372549 -
    0.00250315486390037*pc1 + 0.0005832380602409445*pc2 +
    0.001049287830308963*pc3 - 0.0003659052021377741*pc4 -
    0.002236073957112983*pc5 + 0.001384885744511664*pc6 -
    0.001084238692402688*pc7 + 0.0007626010275613704*pc8 -
    0.001457201357808674*pc9 + 0.002223111127336695*pc10 +
    0.0009660646541798347*pc11 + 0.002185666122533656*pc12 +
    3.275351141917235e-05*pc13 - 0.002012369373777278*pc14 +
    0.003761635149484078*pc15 + 0.0005492658965327594*pc16 +
    0.0002597314649273602*pc17
mixFrac constrained mXY = 0.0122980862745098 + 7.850161918820845e-05*pc1 +
    0.001066500779746187*pc2 + 0.000292701928257359*pc3 +
    0.0005171147607951303*pc4 + 2.603011899399815e-05*pc5 +
    0.0001651824668576445*pc6 - 0.0006728505809365172*pc7 -
    0.0003139112298552687*pc8 - 0.0008786780799835155*pc9 -
    0.0002933109797865396*pc10 - 0.001568599061954829*pc11 -
    0.0004040605375226311*pc12 + 0.0002664485916273241*pc13 -
    0.0003401094681703985*pc14 - 2.424846407058153e-06*pc15 -
    0.0002215383436582665*pc16 + 1.417804351842283e-05*pc17
time fixed  zero = 0
twoN fixed  one = 1
time fixed  TmN = 1        # no coalesc. events can happen b/t 0 and Tv
time fixed  Txynd = 25920  # \citet[table~S12.2, p.~90]{Li:N-505-43-S88}
time constrained TmXY = 0.5*(Txy + Tav)
time constrained TmS = 0.5*(Td + Tnd)
time constrained TmSND = 0.5*(Tnd + Txynd)
segment x    t=zero   twoN=one     samples=1
segment y    t=zero   twoN=one     samples=1
segment v    t=Tv     twoN=twoNn   samples=1
segment a    t=Ta     twoN=twoNn   samples=1
segment a2   t=TmXY   twoN=twoNn
segment d    t=Td     twoN=one     samples=1
segment d2   t=TmS    twoN=one
segment y2   t=TmN    twoN=one
segment n    t=TmN    twoN=twoNn
segment s    t=TmS    twoN=twoNs
segment s2   t=TmSND  twoN=twoNs
segment av   t=Tav    twoN=twoNav
segment nd   t=Tnd    twoN=twoNnd
segment nd2  t=TmSND  twoN=twoNnd
segment xy   t=Txy    twoN=twoNxy
segment xy2  t=TmXY   twoN=twoNxy
segment xynd t=Txynd  twoN=twoNxynd
segment xynds t=Txynds twoN=twoNxynd
mix    d    from d2 + mS * s
mix    y    from y2 + mN * n
mix    a    from a2 + mXY * xy2
mix    nd   from nd2 + mSND * s2
derive n    from v
derive v    from a
derive a2   from av
derive av   from nd
derive d2   from nd
derive x    from xy
derive y2   from xy
derive xy   from xy2
derive xy2  from xynd
derive nd2  from xynd
derive s    from s2
derive s2   from xynds
derive xynd from xynds

